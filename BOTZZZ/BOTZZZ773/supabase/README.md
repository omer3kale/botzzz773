# Supabase Configuration

All Supabase credentials for this project are tracked in `.env.production`. Load it before running CLI commands:

```bash
cd supabase
export $(grep -v '^#' .env.production | xargs)
```

## Apply Migrations to Production

```bash
# Set the remote connection string (requires the DB password from Supabase dashboard)
supabase db remote set "$SUPABASE_DB_URL"

# Push the latest migrations
supabase db push --db-url "$SUPABASE_DB_URL"
```

Migrations live in `supabase/migrations/` and include:

- `20251113_add_order_number_column.sql`
- `20251113_update_order_number_sequence.sql`

Utility SQL files (bulk activation, cleanup, etc.) are in the root of this directory for manual execution through the Supabase SQL editor.

## Local Studio / Auth Settings

The default `supabase/config.toml` generated by the CLI works with the `.env.production` values. Ensure the following redirect URLs exist in Supabase → Authentication → URL Configuration:

- `https://botzzz773.netlify.app`
- `https://botzzz773.netlify.app/auth/callback`

## Secrets Reference

| Variable | Description |
| --- | --- |
| `SUPABASE_PROJECT_ID` | Supabase project reference |
| `SUPABASE_URL` | Base REST & auth endpoint |
| `SUPABASE_ANON_KEY` | Browser key (safe to expose) |
| `SUPABASE_SERVICE_ROLE_KEY` | Server-side key for Netlify functions |
| `SUPABASE_DB_PASSWORD` | Postgres password from Supabase dashboard |
| `SUPABASE_DB_URL` | Connection string used by CLI migrations |
